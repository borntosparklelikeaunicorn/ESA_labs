# Practical Work #4
*Выполнили студенты группы 6132-010402D Макарова Мария и Таджитдинов Камиль* 
## Java Message Service
### Общая задача
Нужно добавить новую функциональность в ранее созданное приложение, а именно: механизм логирования и watchdog для отслеживания определенных изменений.  
Логирование должно обеспечивать простой механизм записи информации об изменениях в системе в специальную таблицу базы данных.  
Watchdog должен отправлять уведомления по электронной почте о конкретных изменениях в системе на указанные адреса электронной почты.

### Задание 1
Была добавлена новая таблица в базу данных, где представлены изменения информации в других таблицах базы данных.
![image](https://github.com/user-attachments/assets/45618a12-8237-4a51-9a1d-e6d0f58e8d09)

`AuditEntity` определяет сущность для хранения записей изменения в других таблицах.

### Задание 2
`MessagingConfig` содержит конфигурацию JMS, включает создание фабрики слушателей и настройку конвертера сообщений.  
Также были обновлены `application.yml` и `pom.xml`.

### Задание 3
`AuditProducerService` отвечает за отправку сообщений в очередь JMS, когда происходят изменения в сущностях. Он создает сообщения типа `CreateMessage` или `DeleteMessage` в зависимости от события.
`AuditMessage`, `CreateMessage`, `DeleteMessage` представляют структуру сообщений, которые отправляются в очередь при изменении сущностей.

Измените ваше приложение так, чтобы оно отправляло сообщение в объект назначения каждый раз, когда изменения применяются к сущностям. Выберите тип и структуру сообщения разумно.

### Задание 4
`AuditMessageConsumerService` принимает сообщения из очереди и сохраняет информацию о событии в таблице `audit`.
`AuditRepository` – Репозиторий для работы с сущностью `AuditEntity`, который сохраняет записи в таблицу `audit`.

Разработайте MDB (Message-Driven Bean) или MDP (Message-Driven POJO) в зависимости от вашей технологической платформы для приема этих сообщений. MDB или MDP должны:
проверять тип и структуру сообщения,
затем делать запись в выделенную таблицу.
### Задание 5
`MailingRulesRepository` предоставляет метод для получения списка email-адресов, связанных с конкретной таблицей.
`MailingRuleEntity` хранит адреса электронной почты для уведомлений и условия для отслеживания изменений.
`AuditMailConsumerService` слушает очередь и, если сообщение связано с определенной таблицей, отправляет уведомление на соответствующие email-адреса.
Выберите тип событий, для которых вы хотите отправлять уведомления. Это могут быть:
изменения конкретной сущности,
изменения сущностей, чьи имена содержат определенную строку,
превышение некоторым атрибутом сущности заданных границ и т.д.
Укажите дополнительную информацию, необходимую для идентификации такого события (например, идентификатор сущности, конкретная строка, границы атрибута и т.д.).

Добавьте новую таблицу в базу данных. Каждая строка таблицы должна содержать:

адрес электронной почты для уведомлений,
информацию об условиях.
### Задание 6
`AuditMailConsumerService` – сервис для обработки сообщений и отправки email-уведомлений на основе полученного сообщения.
`MailingService` – сервис для отправки email-сообщений через SMTP.
`MailingRuleEntity` содержит правила рассылки, определяя, какие email-адреса должны получать уведомления о каких изменениях.
Разработайте MDB или MDP для приема сообщений об изменениях, проверки условий и отправки электронных писем. Возможно, потребуется разработать дополнительные классы.

Задача 7
Обеспечьте совместную работу всех компонентов...

